---
layout: default
---

<article class="post">
  {% assign latest_post = site.posts.first %}
  
  {% if latest_post %}
    <h1 class="post-title"><a href="{{ latest_post.url }}">{{ latest_post.title }}</a></h1>
    <p class="post-date">{{ latest_post.date | date: "%d %B %Y" }}</p>

    <div class="entry">
      {{ latest_post.content }}
    </div>

    <div class="post-navigation">
      <a href="mailto:comments@tacticsjournal.com?subject=Re:%20{{ latest_post.title | uri_escape }}&body={{ site.url }}{{ latest_post.url | uri_escape }}">Reply</a>
      <a href="#top">Back to top</a>

      <script>
        function copyToClipboard() {
          const url = document.URL;
        }
      </script>

      <a href="mailto:?subject={{ latest_post.title }}&body={{ site.url }}{{ latest_post.url }}">Email this post</a>
      {% include copylink.html %} 
    </div>

    <div class="subscribe-section">
      <div class="subscribe-section-header">Subscribe</div>
      <form action="https://buttondown.com/api/emails/embed-subscribe/TacticsJournal" 
            method="post" 
            target="_blank"
            id="subscribeForm">
        <div class="form-container">
          <input type="email" name="email" id="email" placeholder="Enter your email..." required>
          <button type="submit" id="subscribeButton">
            <svg width="15" height="15" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
              <path d="M10 50 L40 80 L90 20" stroke="black" stroke-width="15" fill="none"/>
            </svg>
          </button>
        </div>
      </form>
    </div>
  {% else %}
    <p>No posts available.</p>
  {% endif %}
  
  <div class="archive-filters">
    <a href="#" class="cat-link active" data-cat="all">All</a>
    <a href="#" class="cat-link" data-cat="between-the-posts">Between The Posts</a>
  </div>

  <style>
    .archive-filters { display:flex; gap:.75rem; font-size:12px; }
    .cat-link { text-decoration:none; color:#333; }
    .cat-link.active { border-color:#000; font-weight:bold; }
    .hidden { display:none !important; }
  </style>
  
  <div class="archive">
  {% assign grouped_posts = site.posts | group_by_exp: "post", "post.date | date: '%Y'" %}
  {% for year in grouped_posts %}
    <div class="archive-year">
      {% assign first_month_displayed = false %}
      {% assign month_posts = year.items | group_by_exp: "post", "post.date | date: '%B'" %}
      
      {% for month in month_posts %}
        <div class="year-month">
          {% if first_month_displayed == false %}
            <h3 class="year">{{ year.name }}</h3>
            {% assign first_month_displayed = true %}
          {% else %}
            <h3 class="year-placeholder"></h3>
          {% endif %}
          <h3 class="month">{{ month.name }}</h3>
        </div>

        <ul class="archive-list">
          {% for post in month.items %}
            {% assign day = post.date | date: '%-d' %}
            {% assign last_digit = day | slice: -1 %}
            {% assign suffix = 'th' %}
            
            {% if day != '11' and day != '12' and day != '13' %}
              {% if last_digit == '1' %}
                {% assign suffix = 'st' %}
              {% elsif last_digit == '2' %}
                {% assign suffix = 'nd' %}
              {% elsif last_digit == '3' %}
                {% assign suffix = 'rd' %}
              {% endif %}
            {% endif %}

            {% assign cats_slug = post.categories | map: 'downcase' | join: '|' | replace: ' ', '-' %}
            <li data-cats="{{ cats_slug }}">
              <div class="post-title-archive">
                <a href="{{ post.url }}">{{ post.title | strip_html | escape }}</a>
                <span class="dots-archive"></span>
              </div>
              <span class="post-date-archive">{{ day }}{{ suffix }}</span>
            </li>
          {% endfor %}
        </ul>
      {% endfor %}
    </div>
  {% endfor %}
  </div> <!-- end .archive -->

  <!-- SHOW MORE block (centered) -->
  <div class="archive-more">
    <a href="#" id="show-more">Show More</a>
  </div>

  <style>
    .archive-more { text-align:center; margin:1rem 0 2rem; }
    .archive-more a { text-decoration:none; color:#333; font-size:12px; }
    .archive-more.hidden { display:none; }
  </style>

</article>

<script>
  function goToHomePage() {
    var searchTerm = document.getElementById("search-input")?.value || "";
    window.location.href = "/?search=" + encodeURIComponent(searchTerm);
  }

  const allPostsLink = document.getElementById("all-posts-link");
  if (allPostsLink) {
    allPostsLink.addEventListener("click", function(e) {
      e.preventDefault();
      goToHomePage();
    });
  }
</script>

<!-- Combined: category filter + client-side pagination (40 per click) -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const PAGE_SIZE = 40;

  const links = document.querySelectorAll(".cat-link");
  const posts = Array.from(document.querySelectorAll(".archive-list li[data-cats]"));
  const showMoreWrap = document.querySelector(".archive-more");
  const showMoreBtn  = document.getElementById("show-more");

  let activeCat = "all";
  let visibleLimit = PAGE_SIZE; // how many matched posts to show

  function setActiveLink(cat) {
    links.forEach(l => l.classList.toggle("active", l.dataset.cat === cat));
  }

  function getMatchedPosts(cat) {
    return posts.filter(li => {
      const cats = (li.dataset.cats || "").split("|");
      return (cat === "all") || cats.includes(cat);
    });
  }

  function hideOrShowGroups() {
    // hide empty month lists and year blocks
    document.querySelectorAll(".archive-year").forEach(yearEl => {
      let yearHasVisible = false;
      yearEl.querySelectorAll(".archive-list").forEach(list => {
        const anyVisible = !!list.querySelector("li:not(.hidden)");
        list.classList.toggle("hidden", !anyVisible);
        const headerRow = list.previousElementSibling; // .year-month
        if (headerRow && headerRow.classList.contains("year-month")) {
          headerRow.classList.toggle("hidden", !anyVisible);
        }
        if (anyVisible) yearHasVisible = true;
      });
      yearEl.classList.toggle("hidden", !yearHasVisible);
    });
  }

  function applyFilterAndPaginate() {
    // Hide everything first
    posts.forEach(li => li.classList.add("hidden"));

    // Matched by category
    const matched = getMatchedPosts(activeCat);

    // Show up to visibleLimit
    matched.forEach((li, idx) => {
      if (idx < visibleLimit) {
        li.classList.remove("hidden");
      } else {
        li.classList.add("hidden");
      }
    });

    // Toggle Show More visibility
    const hasMore = matched.length > visibleLimit;
    showMoreWrap.classList.toggle("hidden", !hasMore);

    // Tidy up month/year headers
    hideOrShowGroups();
  }

  // Category clicks
  links.forEach(link => {
    link.addEventListener("click", e => {
      e.preventDefault();
      activeCat = link.dataset.cat;
      visibleLimit = PAGE_SIZE; // reset on category change
      setActiveLink(activeCat);
      applyFilterAndPaginate();
    });
  });

  // Show More click
  if (showMoreBtn) {
    showMoreBtn.addEventListener("click", e => {
      e.preventDefault();
      visibleLimit += PAGE_SIZE; // reveal next 40
      applyFilterAndPaginate();
    });
  }

  // Initial render
  setActiveLink(activeCat);
  applyFilterAndPaginate();
});
</script>

<script src="/js/suggest.js"></script>
<script src="/js/search.js"></script>